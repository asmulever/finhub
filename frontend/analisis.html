<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FinHub | Análisis de instrumentos</title>
  <link rel="icon" href="/logo/favicon.png" />
  <script>
    window.__ENV = window.__ENV ?? {};
    window.__ENV.API_BASE_URL = '/api';
  </script>
  <style>
    :root {
      font-family: 'Inter', system-ui, sans-serif;
      --bg: #050915;
      --panel: #0f172a;
      --border: rgba(148, 163, 184, 0.35);
      --muted: #94a3b8;
      --text: #e2e8f0;
      --accent: #22d3ee;
      --accent-strong: #0ea5e9;
      --green: #22c55e;
      --red: #ef4444;
    }
    * { box-sizing: border-box; }
    body { margin: 0; background: radial-gradient(circle at 15% 20%, #0f172a 0%, #050915 45%, #04060e 100%); color: var(--text); }
    .content-shell { padding: 22px 30px; }
    main { display: grid; gap: 16px; max-width: 1500px; margin: 0 auto; }
    .card { background: var(--panel); border: 1px solid var(--border); border-radius: 16px; padding: 16px 18px; box-shadow: 0 15px 40px rgba(0,0,0,0.45); }
    h1, h2, h3 { margin: 0 0 8px 0; }
    .muted { color: var(--muted); }
    .actions { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    button { background: linear-gradient(120deg, var(--accent), var(--accent-strong)); border: none; color: #041023; padding: 10px 14px; border-radius: 12px; font-weight: 700; cursor: pointer; }
    .pill { font-size: 0.85rem; letter-spacing: 0.06em; padding: 6px 10px; border-radius: 999px; border: 1px solid var(--border); color: var(--text); background: rgba(148, 163, 184, 0.08); }
    .pill-strong { border-color: rgba(34, 211, 238, 0.5); background: rgba(34, 211, 238, 0.08); color: var(--accent); }
    .error { color: #f87171; font-weight: 700; min-height: 20px; }
    .layout { display: grid; grid-template-columns: 360px 1fr; gap: 14px; }
    .list { display: grid; gap: 8px; }
    .item-btn { width: 100%; text-align: left; background: rgba(148,163,184,0.08); border: 1px solid var(--border); border-radius: 10px; padding: 10px; color: var(--text); cursor: pointer; }
    .item-btn.active { border-color: var(--accent); background: rgba(34,211,238,0.08); }
    .two-cols { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .block { background: rgba(148,163,184,0.05); border: 1px solid var(--border); border-radius: 12px; padding: 12px; }
    .row { display: flex; justify-content: space-between; gap: 10px; padding: 4px 0; border-bottom: 1px solid rgba(148,163,184,0.15); }
    .row:last-child { border-bottom: none; }
    .label { color: var(--muted); font-size: 0.9rem; }
    .value { color: var(--text); font-weight: 700; }
    .table { width: 100%; border-collapse: collapse; color: var(--text); }
    .table th, .table td { padding: 8px 10px; border-bottom: 1px solid rgba(148,163,184,0.2); text-align: left; font-size: 0.95rem; }
    .table th { color: var(--muted); font-weight: 700; text-transform: uppercase; letter-spacing: 0.04em; }
    .tag { padding: 4px 8px; border-radius: 10px; border: 1px solid var(--border); font-size: 0.82rem; color: var(--muted); }
    .chart-shell { border: 1px solid var(--border); border-radius: 12px; padding: 12px; background: rgba(148,163,184,0.05); }
    canvas { width: 100%; max-width: 100%; border-radius: 8px; background: #0b1222; }
  </style>
</head>
<body>
  <div class="content-shell">
    <main>
      <section class="card">
        <div style="display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;align-items:flex-start;">
          <div>
            <h2>Análisis de instrumentos</h2>
            <p class="muted">Snapshot, variaciones, FX, sector/industria y datos RAVA por instrumento del portafolio.</p>
          </div>
          <div class="actions">
            <button id="btn-reload" type="button">Recargar</button>
            <span class="pill" id="badge-count">Items: --</span>
            <span class="pill" id="badge-updated">As of: --</span>
            <span class="pill pill-strong" id="badge-base">Base: --</span>
          </div>
        </div>
        <div class="error" id="error-box"></div>
      </section>

      <section class="layout">
        <div class="card">
          <h3>Instrumentos del portafolio</h3>
          <div id="selected-meta" class="muted">0 símbolos</div>
          <div id="instrument-list" class="list" style="margin-top:10px;">
            <p class="muted">Cargando...</p>
          </div>
        </div>
        <div class="card">
          <div class="two-cols">
            <div class="block">
              <h3>Detalle instrumento</h3>
              <div id="analysis-block" class="muted">Selecciona un instrumento.</div>
            </div>
            <div class="block">
              <h3>FX / Sector</h3>
              <div id="details-block" class="muted">Selecciona un instrumento.</div>
            </div>
          </div>
        </div>
      </section>

      <section class="card">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;">
          <div>
            <h3>Histórico normalizado</h3>
            <p class="muted">Selecciona un símbolo para graficar. Un instrumento a la vez.</p>
          </div>
          <div class="actions" style="gap:8px;">
            <select id="chart-symbol" style="background:#0f172a;color:var(--text);border:1px solid var(--border);padding:8px 10px;border-radius:10px;">
              <option value="">Selecciona símbolo</option>
            </select>
            <select id="chart-range" style="background:#0f172a;color:var(--text);border:1px solid var(--border);padding:8px 10px;border-radius:10px;">
              <option value="90">3M</option>
              <option value="180">6M</option>
              <option value="365">1A</option>
            </select>
            <span class="pill" id="chart-meta">Serie: --</span>
          </div>
        </div>
        <div class="chart-shell">
          <canvas id="history-chart" width="1200" height="360"></canvas>
        </div>
      </section>

      <section class="card">
        <h3>Datos RAVA del instrumento</h3>
        <p class="muted">Muestra último, variación y panel si se encuentra en RAVA (mercado argentino).</p>
        <div id="rava-selected" class="muted">Selecciona un instrumento.</div>
      </section>

      <section class="card">
        <h3>Listas RAVA (mercado argentino)</h3>
        <div class="two-cols">
          <div class="block">
            <h4>Acciones AR</h4>
            <div class="muted" id="rava-acciones-meta">Cargando...</div>
            <div style="overflow:auto; max-height:260px;">
              <table class="table" id="tabla-acciones"></table>
            </div>
          </div>
          <div class="block">
            <h4>Bonos AR</h4>
            <div class="muted" id="rava-bonos-meta">Cargando...</div>
            <div style="overflow:auto; max-height:260px;">
              <table class="table" id="tabla-bonos"></table>
            </div>
          </div>
        </div>
        <div class="block" style="margin-top:12px;">
          <h4>CEDEARs</h4>
          <div class="muted" id="rava-cedears-meta">Cargando...</div>
          <div style="overflow:auto; max-height:260px;">
            <table class="table" id="tabla-cedears"></table>
          </div>
        </div>
      </section>
    </main>
  </div>
  <script type="module" src="/Frontend/paginas/analisis.js"></script>
</body>
</html>
