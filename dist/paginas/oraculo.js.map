{
  "version": 3,
  "sources": ["../../Frontend/auth/authStore.js", "../../Frontend/apicliente.js", "../../Frontend/components/loadingOverlay.js", "../../Frontend/paginas/oraculo.js"],
  "sourcesContent": ["const TOKEN_KEY = 'finhub_token';\nconst TOKEN_EXP_KEY = 'finhub_token_exp';\nconst PROFILE_KEY = 'finhub_profile';\nconst storage = sessionStorage;\n\nconst nowSeconds = () => Math.floor(Date.now() / 1000);\n\nexport const authStore = {\n  getToken() {\n    const exp = Number(storage.getItem(TOKEN_EXP_KEY) || 0);\n    if (exp && nowSeconds() >= exp) {\n      this.clearToken();\n      return null;\n    }\n    return storage.getItem(TOKEN_KEY);\n  },\n  setToken(token, expiresInSeconds = 3600) {\n    storage.setItem(TOKEN_KEY, token);\n    storage.setItem(TOKEN_EXP_KEY, String(nowSeconds() + expiresInSeconds));\n  },\n  clearToken() {\n    storage.removeItem(TOKEN_KEY);\n    storage.removeItem(TOKEN_EXP_KEY);\n    storage.removeItem(PROFILE_KEY);\n  },\n  setProfile(profile) {\n    storage.setItem(PROFILE_KEY, JSON.stringify(profile));\n  },\n  getProfile() {\n    const value = storage.getItem(PROFILE_KEY);\n    return value ? JSON.parse(value) : null;\n  },\n};\n", "import { authStore } from './auth/authStore.js';\n\n/** Devuelve en tiempo de ejecuci\u00F3n la URL base que indica el entorno sin ning\u00FAn hardcode. */\nexport const getBaseUrl = (() => {\n  let cached = '';\n  return () => {\n    if (cached !== '') {\n      return cached;\n    }\n    const envBase = window.__ENV?.API_BASE_URL;\n    if (!envBase) {\n      throw new Error('API_BASE_URL no est\u00E1 configurada en window.__ENV');\n    }\n    cached = envBase.endsWith('/') ? envBase.slice(0, -1) : envBase;\n    return cached;\n  };\n})();\n\n/** Construye la URL final agregando la base configurada si la ruta es relativa. */\nconst buildUrl = (path) => (path.startsWith('http') ? path : `${getBaseUrl()}${path}`);\n\n/** Borra el token y redirige al login (forzando la ventana top) si el backend responde con 401. */\nconst handleUnauthorized = () => {\n  authStore.clearToken();\n  const target = '/';\n  if (window.top && window.top !== window) {\n    window.top.location.href = target;\n  } else {\n    window.location.href = target;\n  }\n};\n\n/** Fusiona headers adicionales con el header JSON obligatorio. */\nconst buildHeaders = (extraHeaders) => ({\n  'Content-Type': 'application/json',\n  ...extraHeaders,\n});\n\n/** Extrae el payload JSON o devuelve null si no viene contenido v\u00E1lido. */\nconst parsePayload = async (response) => response.json().catch(() => null);\n\n/**\n * Env\u00EDa una petici\u00F3n HTTP contra la API, gestionando tokens, errores y JSON.\n * @param path Ruta relativa o absoluta del recurso.\n * @param options Configuraci\u00F3n adicional de fetch.\n */\nexport const apiClient = async (path, options = {}) => {\n  const { method = 'GET', body, headers = {}, ...rest } = options;\n  const composedHeaders = buildHeaders(headers);\n  const token = authStore.getToken() ?? localStorage.getItem(\"jwt\");\n\n  if (token) {\n    composedHeaders.Authorization = `Bearer ${token}`;\n  }\n  \n  const response = await fetch(buildUrl(path), {\n    method,\n    credentials: 'include',\n    headers: composedHeaders,\n    body: body === undefined ? undefined : JSON.stringify(body),\n    ...rest,\n  });\n\n  const payload = await parsePayload(response);\n  if (!response.ok) {\n    if (response.status === 401) {\n      handleUnauthorized();\n    }\n    const err = payload?.error ?? {\n      code: `http.${response.status}`,\n      message: response.statusText,\n    };\n    throw { status: response.status, error: err };\n  }\n\n  return payload;\n};\n\n/** Genera un helper para m\u00E9todos que env\u00EDan body JSON. */\nconst withBody = (method) => (path, body) => apiClient(path, { method, body });\n\n/** Genera un helper para m\u00E9todos sin body. */\nconst withoutBody = (method) => (path) => apiClient(path, { method });\n\n/** Env\u00EDa un POST con body serializado. */\nexport const postJson = withBody('POST');\n\n/** Env\u00EDa un PATCH con body serializado. */\nexport const patchJson = withBody('PATCH');\n\n/** Ejecuta una petici\u00F3n DELETE sin body. */\nexport const deleteJson = withoutBody('DELETE');\n\n/** Ejecuta una petici\u00F3n GET sin body. */\nexport const getJson = withoutBody('GET');\n", "const STYLE_ID = 'app-loading-overlay-style';\n\nconst injectStyles = () => {\n  if (document.getElementById(STYLE_ID)) return;\n  const style = document.createElement('style');\n  style.id = STYLE_ID;\n  style.textContent = `\n    .app-loading-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(3, 7, 18, 0.78);\n      backdrop-filter: blur(2px);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n      opacity: 0;\n      pointer-events: none;\n      transition: opacity 0.18s ease;\n    }\n    .app-loading-overlay.visible {\n      opacity: 1;\n      pointer-events: all;\n    }\n    .app-loading-spinner {\n      width: 70px;\n      height: 70px;\n      border-radius: 50%;\n      border: 6px solid rgba(148, 163, 184, 0.35);\n      border-top-color: #22d3ee;\n      animation: app-spin 0.9s linear infinite;\n      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);\n    }\n    @keyframes app-spin {\n      to { transform: rotate(360deg); }\n    }\n  `;\n  document.head.appendChild(style);\n};\n\n/** Crea un overlay reutilizable con spinner centrado. */\nexport const createLoadingOverlay = () => {\n  injectStyles();\n  const overlay = document.createElement('div');\n  overlay.className = 'app-loading-overlay';\n\n  const spinner = document.createElement('div');\n  spinner.className = 'app-loading-spinner';\n  overlay.appendChild(spinner);\n\n  const state = { counter: 0 };\n\n  const show = () => {\n    try {\n      state.counter += 1;\n      if (!overlay.isConnected) {\n        document.body.appendChild(overlay);\n      }\n      overlay.classList.add('visible');\n    } catch (error) {\n      console.info('[loadingOverlay] No se pudo mostrar overlay', error);\n    }\n  };\n\n  const hide = () => {\n    try {\n      state.counter = Math.max(0, state.counter - 1);\n      if (state.counter === 0) {\n        overlay.classList.remove('visible');\n      }\n    } catch (error) {\n      console.info('[loadingOverlay] No se pudo ocultar overlay', error);\n    }\n  };\n\n  const withLoader = async (fn) => {\n    show();\n    try {\n      return await fn();\n    } catch (error) {\n      console.info('[loadingOverlay] Error durante operaci\u00F3n envuelta', error);\n      throw error;\n    } finally {\n      hide();\n    }\n  };\n\n  return { show, hide, withLoader };\n};\n", "import { getJson, postJson } from '../apicliente.js';\nimport { createLoadingOverlay } from '../components/loadingOverlay.js';\n\nconst overlay = createLoadingOverlay();\nconst state = {\n  signals: [],\n  sizing: [],\n  backtestId: null,\n  backtestMetrics: null,\n  backtestEquity: [],\n  backtestTrades: [],\n};\n\nconst formatPct = (v, digits = 1) => (Number.isFinite(v) ? `${(v * 100).toFixed(digits)}%` : '\u2014');\nconst formatNum = (v, digits = 2) => (Number.isFinite(v) ? v.toFixed(digits) : '\u2014');\nconst formatAction = (a) => {\n  const act = String(a ?? '').toUpperCase();\n  if (act === 'BUY') return 'Compra';\n  if (act === 'SELL') return 'Venta';\n  if (act === 'HOLD') return 'Mantener';\n  return act || '\u2014';\n};\n\nconst setStatus = (msg, type = '') => {\n  const el = document.getElementById('signals-status');\n  if (!el) return;\n  el.textContent = msg || '';\n  el.className = `status ${type}`.trim();\n};\n\nconst setError = (id, msg) => {\n  const el = document.getElementById(id);\n  if (!el) return;\n  el.textContent = msg || '';\n};\n\nconst switchTab = (tab) => {\n  document.querySelectorAll('.tab-btn').forEach((btn) => {\n    const isActive = btn.getAttribute('data-tab') === tab;\n    btn.classList.toggle('active', isActive);\n    btn.setAttribute('aria-selected', String(isActive));\n  });\n  document.querySelectorAll('.tab-panel').forEach((panel) => {\n    panel.classList.toggle('active', panel.getAttribute('data-tab-panel') === tab);\n  });\n};\n\nconst bindTabs = () => {\n  document.querySelectorAll('.tab-btn').forEach((btn) => {\n    btn.addEventListener('click', (event) => {\n      event.preventDefault();\n      const tab = btn.getAttribute('data-tab') || 'senales';\n      switchTab(tab);\n    });\n  });\n};\n\nconst normalizeSignal = (s) => ({\n  ...s,\n  symbol: String(s.symbol ?? s.especie ?? '').toUpperCase(),\n  especie: String(s.especie ?? s.symbol ?? '').toUpperCase(),\n  strategy: s.strategy_name ?? s.strategy_id ?? 'N/D',\n  regime: s.regime ?? s.regimen ?? null,\n  holding: s.holding_expectation ?? (Number.isFinite(s.horizon_days) ? `${s.horizon_days}d` : null),\n  entry_reference: Number.isFinite(s.entry_reference) ? Number(s.entry_reference) : Number.isFinite(s.price_last) ? Number(s.price_last) : null,\n  expected_R: Number.isFinite(s.expected_R) ? Number(s.expected_R) : (Number.isFinite(s.risk_reward) ? Number(s.risk_reward) : null),\n  expected_dd_p90: Number.isFinite(s.expected_dd_p90) ? Number(s.expected_dd_p90) : null,\n});\n\nconst renderSignals = () => {\n  const body = document.getElementById('signals-body');\n  if (!body) return;\n  if (!state.signals.length) {\n    body.innerHTML = '<tr><td colspan=\"11\" class=\"muted\">Sin se\u00F1ales disponibles.</td></tr>';\n    return;\n  }\n  body.innerHTML = state.signals.map((s) => {\n    const stopTake = `${formatNum(s.stop_price)} / ${formatNum(s.take_price)}`;\n    const expectedDd = s.expected_dd_p90 ?? s.range_p90_pct ?? null;\n    const expectedR = Number.isFinite(s.expected_R)\n      ? `${s.expected_R.toFixed(2)}R`\n      : (Number.isFinite(s.risk_reward) ? `${s.risk_reward.toFixed(2)}R` : '\u2014');\n    const rationale = s.rationale_short ?? '\u2014';\n    return `\n      <tr>\n        <td>${s.symbol}</td>\n        <td>${formatAction(s.action)}</td>\n        <td>${formatPct(s.confidence, 1)}</td>\n        <td>${s.holding ?? `${s.horizon_days ?? '\u2014'}d`}</td>\n        <td>${(s.regime ?? '').toString().toUpperCase() || '\u2014'}</td>\n        <td>${s.strategy}</td>\n        <td>${formatNum(s.entry_reference)}</td>\n        <td>${stopTake}</td>\n        <td>${expectedR}</td>\n        <td>${expectedDd ? formatPct(expectedDd) : '\u2014'}</td>\n        <td><span class=\"tooltip\" title=\"${rationale}\">\u2139\uFE0F</span></td>\n      </tr>\n    `;\n  }).join('');\n};\n\nconst computeSizing = (capital, riskPct, maxDdPct) => {\n  const results = [];\n  const riskAmount = capital * (riskPct / 100);\n  state.signals.forEach((s) => {\n    const entry = Number(s.entry_reference);\n    const stop = Number(s.stop_price);\n    if (!Number.isFinite(entry) || !Number.isFinite(stop) || entry <= 0 || stop <= 0 || entry === stop) {\n      return;\n    }\n    const riskPerUnit = Math.abs(entry - stop);\n    if (riskPerUnit <= 0) {\n      return;\n    }\n    const sizeUnits = Math.max(0, Math.floor(riskAmount / riskPerUnit));\n    const capitalUsed = sizeUnits * entry;\n    const riskMoney = sizeUnits * riskPerUnit;\n    const expectedR = Number.isFinite(s.expected_R)\n      ? `${s.expected_R.toFixed(2)}R`\n      : (Number.isFinite(s.risk_reward) ? `${s.risk_reward.toFixed(2)}R` : '\u2014');\n    const ddPct = Number.isFinite(s.expected_dd_p90) ? s.expected_dd_p90 : (Number.isFinite(s.range_p90_pct) ? Math.abs(s.range_p90_pct) : null);\n    const ddMoney = Number.isFinite(ddPct) ? capital * ddPct : null;\n    results.push({\n      symbol: s.symbol,\n      action: s.action,\n      stopDistance: riskPerUnit,\n      sizeUnits,\n      capitalUsed,\n      riskMoney,\n      expectedR,\n      expectedDd: ddMoney,\n      ddPct,\n      exceedsDd: Number.isFinite(ddPct) ? (ddPct * 100 > maxDdPct) : false,\n    });\n  });\n  return results;\n};\n\nconst renderRisk = (capital, riskPct, maxDdPct) => {\n  const body = document.getElementById('risk-body');\n  if (!body) return;\n  const rows = computeSizing(capital, riskPct, maxDdPct);\n  state.sizing = rows;\n  if (!rows.length) {\n    body.innerHTML = '<tr><td colspan=\"8\" class=\"muted\">No hay stops v\u00E1lidos para calcular tama\u00F1o.</td></tr>';\n    return;\n  }\n  body.innerHTML = rows.map((r) => `\n    <tr>\n      <td>${r.symbol}</td>\n      <td>${formatAction(r.action)}</td>\n      <td>${formatNum(r.stopDistance)}</td>\n      <td>${r.sizeUnits}</td>\n      <td>${formatNum(r.capitalUsed, 0)}</td>\n      <td>${formatNum(r.riskMoney, 0)}</td>\n      <td>${r.expectedR}</td>\n      <td>${r.expectedDd ? `${formatNum(r.expectedDd, 0)} (${formatPct(r.ddPct)})${r.exceedsDd ? ' \u26A0\uFE0F' : ''}` : '\u2014'}</td>\n    </tr>\n  `).join('');\n};\n\nconst renderProjections = () => {\n  const container = document.getElementById('projections-cards');\n  if (!container) return;\n  if (!state.signals.length) {\n    container.innerHTML = '<div class=\"muted\">Carga se\u00F1ales para estimar escenarios.</div>';\n    return;\n  }\n  container.innerHTML = state.signals.map((s) => {\n    const p50 = Number.isFinite(s.range_p50_pct) ? formatPct(s.range_p50_pct) : '\u2014';\n    const p90 = Number.isFinite(s.range_p90_pct) ? formatPct(s.range_p90_pct) : '\u2014';\n    const dd = Number.isFinite(s.expected_dd_p90) ? formatPct(s.expected_dd_p90) : '\u2014';\n    const exp = Number.isFinite(s.exp_return_pct) ? formatPct(s.exp_return_pct) : '\u2014';\n    return `\n      <div class=\"card-item\">\n        <div style=\"display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap;\">\n          <strong>${s.symbol}</strong>\n          <span class=\"tag\">${formatAction(s.action)}</span>\n        </div>\n        <div class=\"soft\">P50: ${p50} \u00B7 P90: ${p90}</div>\n        <div class=\"soft\">Retorno esperado: ${exp}</div>\n        <div class=\"soft\">DD esperado P90: ${dd}</div>\n        <div class=\"muted\" style=\"font-size:0.88rem;\">Confianza ${formatPct(s.confidence,1)} \u00B7 R\u00E9gimen ${(s.regime ?? '').toString().toUpperCase() || '\u2014'} \u00B7 Estrategia ${s.strategy}</div>\n      </div>\n    `;\n  }).join('');\n};\n\nconst renderBacktests = () => {\n  const container = document.getElementById('backtest-cards');\n  const badge = document.getElementById('backtest-badge');\n  if (!container || !badge) return;\n  if (state.backtestMetrics) {\n    renderBacktestSummaryCards();\n    return;\n  }\n  const withBacktest = state.signals.filter((s) => s.backtest_ref);\n  if (!withBacktest.length) {\n    container.innerHTML = '<div class=\"muted\">Las se\u00F1ales actuales no traen referencias de backtest.</div>';\n    badge.textContent = 'Sin backtests cargados';\n    return;\n  }\n  badge.textContent = `${withBacktest.length} backtests referenciados`;\n  container.innerHTML = withBacktest.map((s) => `\n    <div class=\"card-item\">\n      <div style=\"display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap;\">\n        <strong>${s.symbol}</strong>\n        <span class=\"tag\">Ref: ${s.backtest_ref}</span>\n      </div>\n      <div class=\"soft\">Estrategia: ${s.strategy}</div>\n      <div class=\"soft\">Acci\u00F3n: ${formatAction(s.action)} \u00B7 Confianza ${formatPct(s.confidence,1)}</div>\n      <div class=\"muted\" style=\"font-size:0.88rem;\">Solicita m\u00E9tricas /backtests/{id}/metrics para mostrar CAGR, DD y Sharpe.</div>\n    </div>\n  `).join('');\n};\n\nconst updateBadges = () => {\n  const count = document.getElementById('badge-signals');\n  const updated = document.getElementById('badge-updated');\n  if (count) count.textContent = `${state.signals.length} se\u00F1ales`;\n  if (updated) updated.textContent = `Actualizado: ${new Date().toISOString().slice(0, 16)}`;\n};\n\nconst setBacktestStatus = (msg, type = '') => {\n  const el = document.getElementById('backtest-status');\n  if (!el) return;\n  el.textContent = msg || '';\n  el.className = `status ${type}`.trim();\n};\n\nconst setBacktestError = (msg) => setError('backtest-error', msg);\n\nconst backtestPresets = {\n  conservador: {\n    risk_per_trade_pct: 1.0,\n    commission_pct: 0.6,\n    min_fee: 0,\n    slippage_bps: 6,\n    spread_bps: 4,\n    breakout_lookback_buy: 20,\n    breakout_lookback_sell: 10,\n    atr_multiplier: 2.0,\n  },\n  base: {\n    risk_per_trade_pct: 1.5,\n    commission_pct: 0.6,\n    min_fee: 0,\n    slippage_bps: 4,\n    spread_bps: 3,\n    breakout_lookback_buy: 15,\n    breakout_lookback_sell: 7,\n    atr_multiplier: 1.2,\n  },\n  agresivo: {\n    risk_per_trade_pct: 2.0,\n    commission_pct: 0.6,\n    min_fee: 0,\n    slippage_bps: 3,\n    spread_bps: 2,\n    breakout_lookback_buy: 10,\n    breakout_lookback_sell: 5,\n    atr_multiplier: 1.0,\n  },\n};\n\nconst windowMonths = {\n  '6m': 6,\n  '1y': 12,\n  '2y': 24,\n};\n\nconst getUniverse = () => {\n  const auto = Array.from(new Set(state.signals.map((s) => s.symbol))).filter(Boolean);\n  const input = (document.getElementById('bt-universe')?.value || '').trim();\n  const manual = input ? input.split(',').map((s) => s.trim().toUpperCase()).filter(Boolean) : [];\n  return manual.length ? manual : auto;\n};\n\nconst setUniverseDisplay = () => {\n  const input = document.getElementById('bt-universe');\n  if (!input) return;\n  const auto = Array.from(new Set(state.signals.map((s) => s.symbol))).filter(Boolean);\n  input.value = auto.join(',') || '';\n};\n\nconst computeWindow = (windowKey) => {\n  const months = windowMonths[windowKey] ?? 12;\n  const end = new Date();\n  const start = new Date();\n  start.setMonth(start.getMonth() - months);\n  const toISO = (d) => d.toISOString().slice(0, 10);\n  return { start: toISO(start), end: toISO(end) };\n};\n\nconst renderBacktestMetrics = () => {\n  const box = document.getElementById('backtest-metrics');\n  const badge = document.getElementById('backtest-badge');\n  if (!box || !badge) return;\n  if (!state.backtestMetrics) {\n    box.innerHTML = '<strong>M\u00E9tricas</strong><p class=\"muted\">Ejecuta un backtest para ver resultados.</p>';\n    badge.textContent = 'Listo';\n    return;\n  }\n  const m = state.backtestMetrics;\n  badge.textContent = `Backtest #${state.backtestId}`;\n  box.innerHTML = `\n    <strong>M\u00E9tricas</strong>\n    <div class=\"grid\" style=\"margin-top:8px;\">\n      <div class=\"stat\"><div><strong>CAGR</strong></div><div class=\"soft\">${formatPct(m.cagr ?? m.CAGR ?? 0, 2)}</div></div>\n      <div class=\"stat\"><div><strong>Max DD</strong></div><div class=\"soft\">${formatPct(m.max_drawdown ?? 0, 2)}</div></div>\n      <div class=\"stat\"><div><strong>Sharpe</strong></div><div class=\"soft\">${formatNum(m.sharpe ?? 0, 2)}</div></div>\n      <div class=\"stat\"><div><strong>Sortino</strong></div><div class=\"soft\">${formatNum(m.sortino ?? 0, 2)}</div></div>\n      <div class=\"stat\"><div><strong>Win rate</strong></div><div class=\"soft\">${formatPct(m.win_rate ?? 0, 2)}</div></div>\n      <div class=\"stat\"><div><strong>Profit factor</strong></div><div class=\"soft\">${formatNum(m.profit_factor ?? 0, 2)}</div></div>\n      <div class=\"stat\"><div><strong>Expectancy</strong></div><div class=\"soft\">${formatNum(m.expectancy ?? 0, 2)}</div></div>\n      <div class=\"stat\"><div><strong>Exposure</strong></div><div class=\"soft\">${formatPct(m.exposure ?? 0, 2)}</div></div>\n    </div>\n  `;\n};\n\nconst renderBacktestEquity = () => {\n  const body = document.getElementById('backtest-equity-body');\n  if (!body) return;\n  const rows = (state.backtestEquity || []).filter(\n    (row) => row && row.ts && Number.isFinite(row.equity) && Number.isFinite(row.drawdown)\n  );\n  if (!rows.length) {\n    body.innerHTML = '<tr><td colspan=\"3\" class=\"muted\">Sin equity.</td></tr>';\n    return;\n  }\n  body.innerHTML = rows.slice(-200).map((row) => `\n    <tr>\n      <td>${row.ts}</td>\n      <td>${formatNum(row.equity, 2)}</td>\n      <td>${formatPct(row.drawdown, 2)}</td>\n    </tr>\n  `).join('');\n};\n\nconst renderBacktestTrades = () => {\n  const body = document.getElementById('backtest-trades-body');\n  if (!body) return;\n  if (!state.backtestTrades.length) {\n    body.innerHTML = '<tr><td colspan=\"6\" class=\"muted\">Sin trades.</td></tr>';\n    return;\n  }\n  body.innerHTML = state.backtestTrades.map((t) => `\n    <tr>\n      <td>${t.symbol}</td>\n      <td>${t.entry_ts} @ ${formatNum(t.entry_price, 2)}</td>\n      <td>${t.exit_ts} @ ${formatNum(t.exit_price, 2)}</td>\n      <td>${t.qty}</td>\n      <td>${formatNum(t.pnl_net, 2)}</td>\n      <td>${t.exit_reason}</td>\n    </tr>\n  `).join('');\n};\n\nconst renderBacktestSummaryCards = () => {\n  const container = document.getElementById('backtest-cards');\n  if (!container) return;\n  if (!state.backtestMetrics) {\n    container.innerHTML = '<div class=\"muted\">Ejecuta un backtest para ver el resumen.</div>';\n    return;\n  }\n  const lastEquity = state.backtestEquity.length ? state.backtestEquity[state.backtestEquity.length - 1].equity : null;\n  container.innerHTML = `\n    <div class=\"card-item\">\n      <div><strong>Resultado</strong></div>\n      <div class=\"soft\">Equity final: ${lastEquity ? formatNum(lastEquity, 2) : 'N/D'}</div>\n      <div class=\"soft\">Trades: ${state.backtestTrades.length}</div>\n      <div class=\"muted\" style=\"font-size:0.88rem;\">Ref: backtest #${state.backtestId} \u00B7 Guardado en se\u00F1ales</div>\n    </div>\n  `;\n};\n\nconst loadBacktestDetails = async (id) => {\n  const [metrics, equityResp, tradesResp] = await Promise.all([\n    getJson(`/backtests/${id}/metrics`),\n    getJson(`/backtests/${id}/equity`),\n    getJson(`/backtests/${id}/trades`),\n  ]);\n  state.backtestMetrics = metrics ?? null;\n  state.backtestEquity = Array.isArray(equityResp?.data) ? equityResp.data : [];\n  state.backtestTrades = Array.isArray(tradesResp?.data) ? tradesResp.data : [];\n  renderBacktestMetrics();\n  renderBacktestEquity();\n  renderBacktestTrades();\n  renderBacktestSummaryCards();\n};\n\nconst runBacktest = async () => {\n  setBacktestError('');\n  const universe = getUniverse();\n  if (!universe.length) {\n    setBacktestError('No hay universo detectado (carga se\u00F1ales o define tickers).');\n    return;\n  }\n  const windowKey = document.getElementById('bt-window')?.value || '1y';\n  const profile = document.getElementById('bt-profile')?.value || 'base';\n  const dates = computeWindow(windowKey);\n  const preset = backtestPresets[profile] || backtestPresets.base;\n  const payload = {\n    strategy_id: 'trend_breakout',\n    universe,\n    start: dates.start,\n    end: dates.end,\n    initial_capital: 100000,\n    ...preset,\n  };\n  setBacktestStatus(`Ejecutando backtest (${profile}, ${windowKey})...`, 'info');\n  try {\n    const resp = await postJson('/backtests/run', payload);\n    const id = resp?.id;\n    state.backtestId = id;\n    setBacktestStatus(`Backtest #${id} completado`, '');\n    await loadBacktestDetails(id);\n    await loadSignals({ force: false });\n  } catch (error) {\n    console.info('[oraculo] Backtest error', error);\n    setBacktestStatus('Error al ejecutar backtest', 'error');\n    setBacktestError(error?.error?.message ?? 'No se pudo ejecutar el backtest');\n  }\n};\n\nconst fetchSignals = async ({ force = false, collect = false } = {}) => {\n  const params = [];\n  if (force) params.push('force=1');\n  if (collect) params.push('collect=1');\n  const query = params.length ? `?${params.join('&')}` : '';\n  const resp = await getJson(`/signals/latest${query}`);\n  const data = Array.isArray(resp?.data) ? resp.data : [];\n  return data.map(normalizeSignal);\n};\n\nconst loadSignals = async ({ force = false } = {}) => {\n  setError('signals-error', '');\n  setStatus(force ? 'Recalculando se\u00F1ales...' : 'Cargando se\u00F1ales...');\n  try {\n    const signals = await fetchSignals({ force, collect: true });\n    state.signals = signals;\n    renderSignals();\n    renderProjections();\n    renderBacktests();\n    const capital = Number(document.getElementById('capital-input')?.value ?? 0) || 0;\n    const riskPct = Number(document.getElementById('risk-input')?.value ?? 0) || 0;\n    const maxDdPct = Number(document.getElementById('dd-input')?.value ?? 0) || 0;\n    renderRisk(capital, riskPct, maxDdPct);\n    updateBadges();\n    setStatus('', '');\n  } catch (error) {\n    console.info('[oraculo] No se pudieron cargar se\u00F1ales', error);\n    setError('signals-error', 'No se pudieron cargar las se\u00F1ales.');\n    setStatus('Error al cargar se\u00F1ales', 'error');\n  }\n};\n\nconst bindInputs = () => {\n  document.getElementById('btn-refresh')?.addEventListener('click', () => {\n    overlay.withLoader(() => loadSignals({ force: true })).catch((error) => {\n      console.info('[oraculo] No se pudo recalcular se\u00F1ales', error);\n      setStatus('Error al recalcular', 'error');\n    });\n  });\n\n  const recalc = () => {\n    const capital = Number(document.getElementById('capital-input')?.value ?? 0) || 0;\n    const riskPct = Number(document.getElementById('risk-input')?.value ?? 0) || 0;\n    const maxDdPct = Number(document.getElementById('dd-input')?.value ?? 0) || 0;\n    renderRisk(capital, riskPct, maxDdPct);\n  };\n\n  document.getElementById('btn-recalc-risk')?.addEventListener('click', recalc);\n  document.getElementById('capital-input')?.addEventListener('change', recalc);\n  document.getElementById('risk-input')?.addEventListener('change', recalc);\n  document.getElementById('dd-input')?.addEventListener('change', recalc);\n\n  document.getElementById('btn-run-backtest')?.addEventListener('click', () => {\n    overlay.withLoader(() => runBacktest()).catch(() => {\n      setBacktestStatus('Error al ejecutar backtest', 'error');\n    });\n  });\n};\n\nconst init = async () => {\n  bindTabs();\n  bindInputs();\n  try {\n    await overlay.withLoader(() => loadSignals({ force: true }));\n    setUniverseDisplay();\n  } catch (error) {\n    console.info('[oraculo] Error inicial', error);\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', init);\n"],
  "mappings": "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",
  "names": ["overlay", "state"]
}
